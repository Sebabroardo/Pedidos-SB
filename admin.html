<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin — Santa’s</title>

<!-- Firebase SDKs modular -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAou7COlKKf0mJCnwEefntTKVGI2cxxJrU",
    authDomain: "santa-roti.firebaseapp.com",
    projectId: "santa-roti",
    storageBucket: "santa-roti.appspot.com",
    messagingSenderId: "66221970620",
    appId: "1:66221970620:web:53083ce7727ff85e6d2cb9",
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Cuando se cargue la página, inicializamos el formulario
  window.addEventListener('DOMContentLoaded', () => {
    const form = document.createElement('form');
    form.id = 'productForm';
    form.innerHTML = `
      <h1>Panel Admin — Agregar Producto</h1>
      <input type="text" id="name" placeholder="Nombre del producto" required>
      <input type="text" id="desc" placeholder="Descripción" required>
      <input type="number" id="price" placeholder="Precio" required>
      <input type="text" id="img" placeholder="URL de imagen (opcional)">
      <button type="submit">Guardar producto</button>
    `;
    document.body.appendChild(form);

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const desc = document.getElementById('desc').value.trim();
      const price = parseInt(document.getElementById('price').value);
      const img = document.getElementById('img').value.trim();

      if(!name || !desc || !price) return alert('Todos los campos obligatorios excepto la imagen');

      try {
        await addDoc(collection(db, 'productos'), {
          name,
          desc,
          price,
          img: img || ""
        });
        alert('Producto agregado correctamente');
        form.reset();
      } catch(err) {
        console.error(err);
        alert('Error al guardar producto');
      }
    });
  });
</script>

<style>
  body { font-family: Arial, sans-serif; background:#0f1115; color:#f5f7fb; display:flex; flex-direction:column; align-items:center; padding:20px;}
  input, button { padding:10px; border-radius:8px; border:none; margin:5px 0; font-size:14px; width:320px;}
  button { background:#22c55e; color:#fff; cursor:pointer; font-weight:bold;}
</style>
</head>
<body>
</body>
</html>
