<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Santa Rotiser√≠a ‚Äî Pedidos por WhatsApp</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{--bg:#0f1115;--card:#171a21;--muted:#a9b0be;--text:#f5f7fb;--primary:#22c55e;--accent:#f43f5e;--ring:#2a2f3a;}
*{box-sizing:border-box}
html,body{margin:0;height:100%;font-family:Inter,sans-serif;background:linear-gradient(180deg,#0b0d12,#121622 40%,#0f1115);color:var(--text)}
a{color:inherit;text-decoration:none}
.container{max-width:1100px;margin:0 auto;padding:24px}
header{display:flex;align-items:center;justify-content:space-between;padding:18px 0}
.brand{display:flex;gap:12px;align-items:center}
.logo {
  width: 64px;
  height: 64px;
  border-radius: 12px; 
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
}
.logo img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}
.brand h1{font-size:20px;margin:0}
.tag{font-size:12px;color:var(--muted)}
.hero{padding:18px;border:1px solid var(--ring);background:radial-gradient(1200px 400px at 10% -5%,rgba(34,197,94,.25),transparent 40%),radial-gradient(800px 300px at 110% -10%,rgba(244,63,94,.20),transparent 40%),var(--card);border-radius:20px;display:grid;grid-template-columns:1.3fr .7fr;gap:18px}
.hero .copy h2{font-size:28px;margin:0 0 8px}
.hero .copy p{margin:0;color:var(--muted)}
.hero .info{display:grid;gap:8px;align-content:start}
.pill{display:inline-flex;gap:8px;align-items:center;background:#0c0f14;border:1px solid var(--ring);border-radius:999px;padding:8px 12px;font-size:12px;color:var(--muted)}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin-top:22px}
.card{background:var(--card);border:1px solid var(--ring);border-radius:18px;padding:14px}
.product{display:flex;flex-direction:column;gap:10px}
.product .img{height:140px;border-radius:14px;background:#10141c;border:1px dashed #2f3644;display:grid;place-items:center;font-size:12px;color:#97a0b2;overflow:hidden}
.product img{width:100%;height:100%;object-fit:cover;border-radius:14px}
.product h3{margin:0;font-size:16px}
.product p{margin:0;color:var(--muted);font-size:13px}
.price{font-weight:700}
.qty{display:flex;align-items:center;gap:8px;margin-top:4px}
.qty button{width:28px;height:28px;border-radius:8px;border:1px solid var(--ring);background:#0c0f14;color:var(--text);cursor:pointer}
.actions{display:flex;gap:8px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 12px;border-radius:12px;border:1px solid var(--ring);background:#0c0f14;color:var(--text);cursor:pointer}
.btn.primary{background:linear-gradient(180deg,#23d164,#18b956);border:none}
.col-9{grid-column:span 9}
.col-3{grid-column:span 3}
@media (max-width:900px){.hero{grid-template-columns:1fr}.col-9,.col-3{grid-column:1/-1}}
.cart{position:sticky;top:12px;display:grid;gap:10px}
.cart h3{margin:0 0 6px}
.cart-list{display:grid;gap:8px;max-height:360px;overflow:auto;padding-right:6px}
.cart-item{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px;border:1px solid var(--ring);border-radius:12px;background:#0c0f14}
.cart-item .title{font-size:13px}
.cart-item .ops{display:flex;align-items:center;gap:6px}
.cart-item .ops button{width:24px;height:24px;border-radius:6px;border:1px solid var(--ring);background:#141824;color:var(--text);cursor:pointer}
.tot{display:flex;align-items:center;justify-content:space-between;font-weight:800}
.muted{color:var(--muted);font-size:12px}
.inputs{display:grid;gap:10px}
.inputs input, .inputs textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--ring);background:#0c0f14;color:var(--text)}
.inputs textarea{min-height:72px;resize:vertical}
footer{margin-top:22px;color:var(--muted);font-size:12px;text-align:center}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="brand">
      <div class="logo">
        <img src="logo.png" alt="Santa Rotiser√≠a">
      </div>
      <div>
        <h1>Santa‚Äôs</h1>
        <div class="tag">Rotiser√≠a ‚Äî Pedidos por WhatsApp</div>
      </div>
    </div>
    <div class="pill">‚è±Ô∏è Hoy: 20:00 ‚Äì 23:30¬∑ üìç Cintra</div>
  </header>

  <section class="hero card">
    <div class="copy">
      <h2>Hac√© tu pedido online y confirmalo por WhatsApp</h2>
      <p>Eleg√≠ tu pedido, agregalo al carrito y presion√° ‚ÄúEnviar por WhatsApp‚Äù. Te llega el mensaje listo para confirmar con nuestra atenci√≥n.</p>
    </div>
    <div class="info">
      <div class="pill">üöö Env√≠os y retiro en local</div>
      <div class="pill">üí≥ Efectivo, D√©bito/Cr√©dito, QR</div>      
    </div>
  </section>

  <section class="col-9">
    <h2>Pizzas</h2>
    <div id="pizzas" class="grid" style="grid-template-columns:repeat(auto-fill,minmax(240px,1fr));"></div>

    <h2>Hamburguesas</h2>
    <div id="hamburguesas" class="grid" style="grid-template-columns:repeat(auto-fill,minmax(240px,1fr));"></div>

    <h2>Papas</h2>
    <div id="papas" class="grid" style="grid-template-columns:repeat(auto-fill,minmax(240px,1fr));"></div>

    <h2>Men√∫ Especial</h2>
    <div id="menuEspecial" class="grid" style="grid-template-columns:repeat(auto-fill,minmax(240px,1fr));"></div>

    <h2>Extras</h2>
    <div id="extras" class="grid" style="grid-template-columns:repeat(auto-fill,minmax(240px,1fr));"></div>
  </section>

  <aside class="col-3">
    <div class="card cart">
      <h3>üõí Tu pedido</h3>
      <div class="cart-list" id="cartList"></div>
      <div class="tot"><span>Total</span><span id="total">$0</span></div>
      <div class="inputs">
        <input id="customerName" placeholder="Tu nombre"/>
        <input id="customerAddress" placeholder="Direcci√≥n (si ped√≠s env√≠o)"/>
        <textarea id="customerNotes" placeholder="Notas para la cocina (sin mayonesa, m√°s ketchup, etc.)"></textarea>
      </div>
      <button class="btn primary" id="whatsBtn">üì≤ Enviar pedido por WhatsApp</button>
      <div class="muted">Al hacer clic se abrir√° WhatsApp con el detalle de tu pedido para confirmar.</div>
    </div>
  </aside>

  <footer>
    ¬© <span id="year"></span> Santa ¬∑ Hecho con ‚ô•
  </footer>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAou7COlKKf0mJCnwEefntTKVGI2cxxJrU",
  authDomain: "santa-roti.firebaseapp.com",
  projectId: "santa-roti",
  storageBucket: "santa-roti.firebasestorage.app",
  messagingSenderId: "66221970620",
  appId: "1:66221970620:web:53083ce7727ff85e6d2cb9",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const state = { cart: {} };
const currency = new Intl.NumberFormat('es-AR',{ style:'currency', currency:'ARS', maximumFractionDigits:0 });

function renderCart() {
  const list = document.getElementById('cartList');
  list.innerHTML = '';
  let total = 0;
  Object.values(state.cart).forEach(({ product, qty }) => {
    total += product.price * qty;
    const row = document.createElement('div');
    row.className = 'cart-item';
    row.innerHTML = `
      <div>
        <div class="title">${product.name}</div>
        <div class="muted">${qty} √ó ${currency.format(product.price)}</div>
      </div>
      <div class="ops">
        <button data-id="${product.id}" data-op="-">‚àí</button>
        <span>${qty}</span>
        <button data-id="${product.id}" data-op="+">Ôºã</button>
      </div>`;
    list.appendChild(row);
  });

  list.onclick = (e) => {
    if(e.target.tagName !== 'BUTTON') return;
    const id = e.target.getAttribute('data-id');
    const op = e.target.getAttribute('data-op');
    const item = state.cart[id];
    if(!item) return;
    item.qty = Math.max(0, item.qty + (op==='+'?1:-1));
    if(item.qty===0) delete state.cart[id]; else state.cart[id]=item;
    renderCart();
  };

  document.getElementById('total').textContent = currency.format(total);
}

function buildWhatsAppMessage() {
  const entries = Object.values(state.cart);
  if(entries.length===0) { alert('Agreg√° al menos 1 producto al carrito.'); return null; }
  const name = document.getElementById('customerName').value.trim();
  const addr = document.getElementById('customerAddress').value.trim();
  const notes = document.getElementById('customerNotes').value.trim();

  const lines = ['üßæ *Nuevo pedido ‚Äî Santa‚Äôs*',''];
  entries.forEach(({ product, qty }) => lines.push(`‚Ä¢ ${product.name} √ó ${qty} ‚Äî ${currency.format(product.price*qty)}`));
  const total = entries.reduce((acc,{product,qty})=>acc+product.price*qty,0);
  lines.push('',`*Total:* ${currency.format(total)}`);
  if(name) lines.push(`*Nombre:* ${name}`);
  if(addr) lines.push(`*Direcci√≥n:* ${addr}`);
  if(notes) lines.push(`*Notas:* ${notes}`);
  lines.push('','Enviado desde la web de pedidos ‚úÖ');
  return lines.join('\n');
}

document.getElementById('whatsBtn').addEventListener('click', () => {
  const msg = buildWhatsAppMessage();
  if(!msg) return;
  const url = `https://wa.me/+543537581341?text=${encodeURIComponent(msg)}`;
  window.open(url,'_blank');
});

// Render productos desde Firestore en tiempo real, separados por categor√≠a
onSnapshot(collection(db,"productos"), snapshot => {
  // Limpiar todos los contenedores
  ['pizzas','hamburguesas','papas','menuEspecial','extras'].forEach(id => document.getElementById(id).innerHTML = '');
  
  snapshot.forEach(doc => {
    const p = doc.data();
    const id = doc.id;
    const card = document.createElement('div');
    card.className = 'card product';
    card.innerHTML = `
      <div class="img">${p.img ? `<img src="${p.img}" alt="${p.name}">` : `Imagen ${p.name}`}</div>
      <div>
        <h3>${p.name}</h3>
        <p>${p.desc}</p>
      </div>
      <div class="actions">
        <div class="price">${currency.format(p.price)}</div>
        <div class="qty">
          <button data-id="${id}" data-op="-">‚àí</button>
          <span id="qty-${id}">0</span>
          <button data-id="${id}" data-op="+">Ôºã</button>
        </div>
      </div>`;
    
    let containerId;
    switch(p.category) {
      case 'pizza': containerId = 'pizzas'; break;
      case 'hamburguesa': containerId = 'hamburguesas'; break;
      case 'papas': containerId = 'papas'; break;
      case 'menu especial': containerId = 'menuEspecial'; break;
      case 'extras': containerId = 'extras'; break;
      default: containerId = 'pizzas';
    }
    document.getElementById(containerId).appendChild(card);

    // Agregar funcionalidad a botones de cantidad
    const btns = card.querySelectorAll('button');
    btns.forEach(btn => {
      btn.addEventListener('click', () => {
        const op = btn.getAttribute('data-op');
        const pid = btn.getAttribute('data-id');
        if(!state.cart[pid]) state.cart[pid] = { product: {...p, id: pid}, qty: 0 };
        const item = state.cart[pid];
        item.qty = Math.max(0, item.qty + (op==='+'?1:-1));
        if(item.qty===0) delete state.cart[pid]; else state.cart[pid]=item;
        document.getElementById(`qty-${pid}`).textContent = item.qty;
        renderCart();
      });
    });
  });
});

document.getElementById('year').textContent = new Date().getFullYear();
</script>
</body>
</html>
